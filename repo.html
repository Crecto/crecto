
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Repo Â· crecto</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    
    <link rel="prev" href="validations.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Crecto
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="schema.html">
            
                <a href="schema.html">
            
                    
                    Schema
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="associations.html">
            
                <a href="associations.html">
            
                    
                    Associations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="validations.html">
            
                <a href="validations.html">
            
                    
                    Validations
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.3" data-path="repo.html">
            
                <a href="repo.html">
            
                    
                    Repo
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Repo</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="repo">Repo</h1>
<p>The Repo maps to the datastore through the database adapter, and is used to perform queries.  Multiple Repos can be created and used simultaneously if mapping to multiple data sources is required.</p>
<p>Create a module, named whatever you want, extending <code>Crecto::Repo</code>.  Then set the <code>config</code> options.</p>
<pre><code class="lang-crystal"><span class="hljs-class"><span class="hljs-keyword">module</span> <span class="hljs-title">MyRepo</span></span>
  <span class="hljs-keyword">extend</span> <span class="hljs-symbol">Crecto:</span>:Repo

  config <span class="hljs-keyword">do</span> |c|
    c.adapter = <span class="hljs-symbol">Crecto:</span>:<span class="hljs-symbol">Adapters:</span>:Postgres
    c.uri = ENV[<span class="hljs-string">&quot;PG_URL&quot;</span>]
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Then use the Repo to run queries:</p>
<pre><code class="lang-crystal">user = User.new
user.name = <span class="hljs-string">&quot;James Howlett&quot;</span>
changeset = MyRepo.insert(user)
</code></pre>
<p>config accepts the following options:</p>
<pre><code class="lang-crystal">config <span class="hljs-keyword">do</span> |c|
  <span class="hljs-comment"># Choose an adapter for the repo to use: Crecto::Adapters::Postgres, Crecto::Adapters::Mysql, Crecto::Adapters::SQLite3</span>
  c.adapter = <span class="hljs-symbol">Crecto:</span>:<span class="hljs-symbol">Adapters:</span>:Postgres

  <span class="hljs-comment"># If `uri` is specified, the remaining config options will be ignored.  uri is usefull if you have an ENV variable with connection settings</span>
  c.uri = ENV[<span class="hljs-string">&quot;PG_URL&quot;</span>]

  <span class="hljs-comment"># Datbase path, only used for SQLite3 adpater</span>
  c.database = <span class="hljs-string">&quot;/path/to/database.db&quot;</span>

  <span class="hljs-comment"># Database host</span>
  c.hostname = <span class="hljs-string">&quot;localhost&quot;</span>

  <span class="hljs-comment"># Database port</span>
  c.port = <span class="hljs-number">5432</span>

  <span class="hljs-comment"># Database name</span>
  c.database = <span class="hljs-string">&quot;database_name&quot;</span>

  <span class="hljs-comment"># Database username</span>
  c.username = <span class="hljs-string">&quot;db_username&quot;</span>

  <span class="hljs-comment"># Database password</span>
  c.password = <span class="hljs-string">&quot;password1234&quot;</span>

  <span class="hljs-comment"># Initial pool size, default 1</span>
  c.initial_pool_size = <span class="hljs-number">1</span>

  <span class="hljs-comment"># Max pool size, default 0</span>
  c.max_pool_size = <span class="hljs-number">25</span>

  <span class="hljs-comment"># Max idle pool size, default 1</span>
  c.max_idle_pool_size = <span class="hljs-number">5</span>

  <span class="hljs-comment"># Checkout timeout, default 5.0</span>
  c.checkout_timeout = <span class="hljs-number">2.5</span>

  <span class="hljs-comment"># Retry attempts, default 1</span>
  c.retry_attempts = <span class="hljs-number">2</span>

  <span class="hljs-comment"># Retry delay, default 1.0</span>
  c.retry_delay = <span class="hljs-number">0.5</span>

<span class="hljs-keyword">end</span>
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="validations.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: Validations">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Repo","level":"1.3","depth":1,"previous":{"title":"Validations","level":"1.2.2","depth":2,"path":"validations.md","ref":"validations.md","articles":[]},"dir":"ltr"},"config":{"plugins":["github","edit-link"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"fontsettings":{"theme":"night","family":"sans","size":2},"github":{"url":"https://github.com/fridgerator/crecto"},"edit-link":{"label":"Edit This Page","base":"https://github.com/fridgerator/crecto/edit/gh-pages/"},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"crecto","gitbook":"*"},"file":{"path":"repo.md","mtime":"2017-04-05T13:47:09.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-04-06T00:07:19.030Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

